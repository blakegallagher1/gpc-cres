# Entitlement OS v1.0 - Local/Dev Environment Variables
#
# Copy to `.env` and fill in values. Do not commit `.env`.

# Postgres (Supabase or local dev)
# - DATABASE_URL: MUST use port 6543 (Supavisor Transaction Mode) for serverless.
#   Port 5432 (Session Mode) exhausts connections under parallel LLM tool calls.
# - DIRECT_DATABASE_URL: direct connection for Prisma migrations (port 5432 OK)
# - READ_REPLICA_DATABASE_URL: optional pooled read replica for read-heavy endpoints
DATABASE_URL="postgresql://postgres:postgres@localhost:54321/entitlement_os?schema=public"
DIRECT_DATABASE_URL="postgresql://postgres:postgres@localhost:54321/entitlement_os?schema=public"
READ_REPLICA_DATABASE_URL=""
ENABLE_READ_REPLICA="false"
# Optional Prisma pool tuning (query string params are appended when missing)
PRISMA_CONNECTION_LIMIT="15"
PRISMA_POOL_TIMEOUT_SECONDS="20"

# Supabase (Auth + Storage)
SUPABASE_URL="https://YOUR_PROJECT.supabase.co"
SUPABASE_SERVICE_ROLE_KEY="YOUR_SUPABASE_SERVICE_ROLE_KEY"
NEXT_PUBLIC_SUPABASE_URL="https://YOUR_PROJECT.supabase.co"
NEXT_PUBLIC_SUPABASE_ANON_KEY="YOUR_SUPABASE_ANON_KEY"
# Optional Supabase custom domain (if enabled in dashboard)
SUPABASE_CUSTOM_DOMAIN_URL=""
NEXT_PUBLIC_SUPABASE_CUSTOM_DOMAIN_URL=""
# Optional explicit property DB override for parcel/map routes.
# If unset, server routes fall back to SUPABASE_URL + SUPABASE_SERVICE_ROLE_KEY.

# Screening / Copilot / Deal-room backend (public web origin required at runtime)
# Production/preview requires this to point to your deployed FastAPI/backend host.
NEXT_PUBLIC_BACKEND_URL="https://YOUR_SCREENING_BACKEND_URL"

# OpenAI
OPENAI_API_KEY="YOUR_OPENAI_API_KEY"
OPENAI_PARISH_PACK_MODEL="gpt-5.2"
OPENAI_TRIAGE_MODEL="gpt-5.2"
OPENAI_ARTIFACT_MODEL="gpt-5.2"

# Temporal
TEMPORAL_ADDRESS="localhost:7233"
TEMPORAL_NAMESPACE="default"
TEMPORAL_TASK_QUEUE="entitlement-os"

# One-time migration: copy epa_facilities, fema_flood, soils, wetlands from GPC-MOAT
# Get from Supabase Dashboard → GPC-MOAT (jueyosscalcljgdorrpy) → Settings → Database → Connection string (URI)
# GPC_MOAT_DATABASE_URL="postgresql://postgres.[ref]:[pw]@aws-0-us-east-1.pooler.supabase.com:6543/postgres"

# Optional: enable more verbose logs in worker
LOG_LEVEL="info"

# Chat session memory/runtime tuning (optional)
AGENT_SESSION_COMPACTION_TOKEN_THRESHOLD="6000"
AGENT_SESSION_COMPACTION_KEEP_RECENT_MESSAGES="24"
AGENT_SESSION_DEDUPE_LOOKBACK="200"
